---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import { languages } from "../../../i18n/ui";
import { getLangFromUrl, useTranslations } from "../../../i18n/utils";
import MemberPicture from "../../../components/MemberPicture.astro";
import SocialMedia from "../../../components/SocialMedia.astro";

export async function getStaticPaths() {
  const members = await getCollection("members");

  return Object.keys(languages).flatMap((lang) => {
    return members.flatMap((member) => {
      return { params: { lang, id: member.id }, props: member };
    });
  });
}

const member = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<BaseLayout title={t("nav.members")}>
  <div class="flex gap-x-6">
    <div class="">
      {
        member.data.img ? (
          <MemberPicture
            imagePath={member.data.img}
            alt={member.data.name}
            class="max-w-sm border-4" 
          />
        ) : (
          <img src="/assets/default-brain.svg" alt="Default member image" />
        )
      }
    </div>

    <div class="">
      <h1 class="text-3xl">{member.data.name}</h1>
      <h2 class="">{member.data.role}</h2>

      {
        member.data.socialmedia && (
          <SocialMedia socialmedia={member.data.socialmedia} />
        )
      }

      <div class="mt-3">
        {member.data.info[lang]}
      </div>
    </div>
  </div>
</BaseLayout>
